--------recupuration de la db-------------
-- SELECT * FROM tutorial.dc_bikeshare_q1_2012
------Selection bike number et duration
-- SELECT bike_number,
--       SUM(duration_seconds)/3600 AS duration_hours
-- FROM tutorial.dc_bikeshare_q1_2012
-- GROUP BY bike_number
-- ORDER BY duration_hours DESC;
-----Étape 1: Sélectionner bike_number et duration_seconds
SELECT
  bike_number,
  duration_seconds
FROM
  tutorial.dc_bikeshare_q1_2012;

-----Étape 2: Organiser les Résultats par duration_seconds
SELECT
  bike_number,
  duration_seconds
FROM
  tutorial.dc_bikeshare_q1_2012
ORDER BY
  duration_seconds DESC;

----Étape 3: Limiter les Résultats à 300
SELECT
  bike_number,
  duration_seconds
FROM
  tutorial.dc_bikeshare_q1_2012
ORDER BY
  duration_seconds DESC
LIMIT
  300;

---Étape 4: Convertir duration_seconds en Heures et Renommer la Colonne
SELECT
  bike_number,
  duration_seconds / 3600 AS duration_hours
FROM
  tutorial.dc_bikeshare_q1_2012
ORDER BY
  duration_seconds DESC
LIMIT
  300;

-- Cette requête finale répondra aux critères de validation :
-- Elle liste les 300 vélos ayant le plus d'heures d'utilisation.
-- Les colonnes sont intitulées bike_number et duration_hours.
-- Les vélos les plus utilisés sont listés en premier.
-- Le temps d'utilisation maximal est affiché en heures.
------Étape 5: Grouper par bike_number et Faire la Somme des duration_seconds
SELECT
  bike_number,
  SUM(duration_seconds) / 3600 AS duration_hours
FROM
  tutorial.dc_bikeshare_q1_2012
GROUP BY
  bike_number
ORDER BY
  duration_hours DESC
LIMIT
  300;



"bike_number","duration_hours"
"W01245",175.41194444444446
"W01327",153.11138888888888
"W00442",152.36888888888888
"W01221",141.76583333333335
"W01254",136.19472222222223
"W01262",134.93833333333333
"W01179",131.57611111111112
"W01242",131.25277777777777
"W00965",129.66444444444446
"W01180",129.57472222222222
"W01239",128.97333333333333
"W00438",128.24944444444444
"W01397",127.13833333333334
"W01285",126.4475
"W01324",124.95972222222223
"W01174",122.12305555555555
"W00356",122.09
"W01212",121.82861111111112
"W01321",121.75611111111111
"W01462",121.3625
"W01460",119.98444444444445
"W01151",119.31833333333333
"W01467",118.89611111111111
"W01182",118.75833333333334
"W01222",118.2688888888889
"W01331",118.07583333333334
"W00817",117.3175
"W01201",116.93805555555555
"W01268",116.78083333333333
"W01456",116.42222222222222
"W01178",115.94916666666667
"W01271",115.69472222222223
"W00931",115.21083333333333
"W01005",115.09777777777778
"W00530",114.3925
"W01266",113.98194444444445
"W01215",113.39777777777778
"W01234",113.09083333333334
"W01474",113.04416666666667
"W01385",112.78416666666666
"W01337",112.535
"W01436",112.2088888888889
"W01341",111.71138888888889
"W00035",111.48694444444445
"W01183",111.26361111111112
"W01470",111.23333333333333
"W01399",111.14805555555556
"W01414",111.0825
"W00244",110.75527777777778
"W01220",110.54972222222223
"W01359",110.38805555555555
"W01196",110.04833333333333
"W00881",109.6661111111111
"W01247",109.1
"W01204",108.88277777777778
"W01155",108.715
"W01469",108.65027777777777
"W01484",108.43555555555555
"W01216",108.43305555555555
"W01303",107.99166666666666
"W01312",107.91666666666667
"W00918",107.57388888888889
"W01200",107.49388888888889
"W01373",107.16694444444444
"W00196",106.57916666666667
"W01299",106.495
"W01453",105.9786111111111
"W00822",105.89833333333333
"W01233",105.81166666666667
"W01225",105.75305555555556
"W01279",105.69944444444444
"W00656",105.50444444444445
"W00079",105.41916666666667
"W00776",105.2875
"W01311",105.26916666666666
"W01153",105.23222222222222
"W01264",105.22
"W01198",104.80833333333334
"W01265",104.625
"W01205",104.56222222222222
"W01187",104.48527777777778
"W00206",104.21638888888889
"W00983",104.09777777777778
"W00224",104.07111111111111
"W00963",103.74944444444445
"W01057",103.745
"W00964",103.69055555555556
"W01351",103.525
"W01333",103.45527777777778
"W01355",103.44916666666667
"W01409",103.34944444444444
"W01209",103.29194444444444
"W01356",102.95194444444445
"W01190",102.83888888888889
"W01398",102.77888888888889
"W01211",102.63305555555556
"W00677",102.18027777777777
"W01158",102.17972222222222
"W01421",102.12055555555555
"W01181",101.51583333333333
"W00679",101.47305555555556
"W00225",101.43722222222222
"W01160",101.38638888888889
"W01304",101.38138888888889
"W01197",101.27638888888889
"W00735",101.22305555555556
"W00258",101.02388888888889
"W01457",100.94194444444445
"W00362",100.8425
"W01230",100.83361111111111
"W01259",100.73444444444445
"W01237",100.63416666666667
"W01323",100.61638888888889
"W01002",100.39444444444445
"W00475",100.37611111111111
"W01283",100.24027777777778
"W01186",100.17027777777778
"W00329",100.03972222222222
"W01468",100.0075
"W00378",99.80527777777777
"W01203",99.80027777777778
"W00227",99.7311111111111
"W00060",99.70861111111111
"W01296",99.64972222222222
"W01376",99.54666666666667
"W01464",99.54583333333333
"W00375",99.48027777777777
"W00557",99.47916666666667
"W01290",99.20805555555556
"W01342",99.17916666666666
"W01330",99.0886111111111
"W01300",99.04916666666666
"W01295",98.87472222222222
"W01316",98.74222222222222
"W00905",98.415
"W01172",98.32
"W01074",98.11611111111111
"W00246",98.01
"W01482",97.40583333333333
"W01269",97.29916666666666
"W00021",97.28611111111111
"W00972",97.1725
"W01173",97.15555555555555
"W00261",96.96722222222222
"W00950",96.93222222222222
"W01236",96.8
"W01425",96.78527777777778
"W00495",96.65472222222222
"W00520",96.5436111111111
"W01297",96.44277777777778
"W01251",96.43138888888889
"W01338",96.32972222222222
"W01243",96.25194444444445
"W01375",96.2461111111111
"W00533",96.24361111111111
"W00558",96.2213888888889
"W01213",96.11055555555555
"W01231",96.04333333333334
"W01458",96.015
"W01104",95.94638888888889
"W01282",95.92722222222223
"W00585",95.80583333333334
"W01228",95.79777777777778
"W01124",95.65277777777777
"W00353",95.44166666666666
"W01052",95.31611111111111
"W01241",95.31277777777778
"W01218",95.08888888888889
"W01159",94.81333333333333
"W01326",94.765
"W00719",94.76333333333334
"W01294",94.74027777777778
"W00816",94.68861111111111
"W01310",94.62361111111112
"W01459",94.6036111111111
"W00738",94.57666666666667
"W00801",94.52416666666667
"W01360",94.51388888888889
"W00202",94.21916666666667
"W01302",94.18194444444444
"W00903",93.99083333333333
"W01136",93.94333333333333
"W01053",93.87805555555556
"W00477",93.80611111111111
"W01455",93.51944444444445
"W00754",93.35861111111112
"W00833",93.32694444444445
"W01339",93.25444444444445
"W01393",93.17722222222223
"W01199",93.17361111111111
"W00842",93.16444444444444
"W00989",93.16222222222223
"W00610",93.05555555555556
"W01480",93.01305555555555
"W01184",92.925
"W01000",92.73722222222223
"W01367",92.71055555555556
"W01195",92.61916666666667
"W01365",92.5875
"W00858",92.53222222222222
"W01223",92.47222222222223
"W01191",92.44611111111111
"W01189",92.44361111111111
"W01344",92.42027777777778
"W00818",92.41944444444445
"W01175",92.40138888888889
"W00799",92.33638888888889
"W00050",92.20861111111111
"w00765",92.12055555555555
"W01306",92.11972222222222
"W01255",92.08583333333333
"W01185",92.02166666666666
"W00546",91.80444444444444
"W00133",91.76583333333333
"W01270",91.74277777777777
"W01079",91.65027777777777
"W00267",91.39555555555556
"W01210",91.34333333333333
"W01486",91.14416666666666
"W00968",91.09555555555555
"W00680",91.02833333333334
"W01046",90.96722222222222
"W01357",90.885
"W00229",90.87444444444445
"W00446",90.87138888888889
"W01080",90.84
"W01193",90.78861111111111
"W01362",90.78305555555555
"w00644",90.54416666666667
"W01267",90.41305555555556
"W00020",90.37805555555556
"W01391",90.36166666666666
"W00070",90.33888888888889
"W01293",90.25361111111111
"W00537",90.21916666666667
"W00855",90.21833333333333
"W01217",90.19194444444445
"W00333",90.10166666666667
"W00076",89.87777777777778
"W00662",89.85388888888889
"W00562",89.68833333333333
"W00443",89.60972222222222
"W01154",89.6
"W01343",89.55111111111111
"W00087",89.48527777777778
"W00865",89.4636111111111
"W00411",89.28277777777778
"W00856",89.28138888888888
"W00474",89.12944444444445
"W01291",89.10916666666667
"W01260",88.92694444444444
"W01313",88.87722222222222
"W00891",88.83555555555556
"W00731",88.72527777777778
"W01208",88.64722222222223
"W00736",88.64666666666666
"W00007",88.51444444444445
"W01487",88.4786111111111
"W01307",88.43666666666667
"W00938",88.37722222222222
"W00874",88.28166666666667
"W01278",88.26388888888889
"W00944",88.2611111111111
"W00199",88.15527777777778
"W01171",88.10805555555555
"W00716",88.09611111111111
"W01006",88.03305555555555
"W00791",88.02277777777778
"W01240",87.91833333333334
"W00588",87.89583333333333
"W01389",87.8725
"W00665",87.84861111111111
"W00668",87.80805555555555
"W01465",87.80444444444444
"W00898",87.75194444444445
"W01412",87.56111111111112
"W01314",87.43666666666667
"W00812",87.31305555555555
"W00519",87.25833333333334
"W01035",87.22611111111111
"W00247",87.19083333333333
"W00591",87.16583333333334
"W00568",86.98833333333333
"W00666",86.82055555555556
"W00476",86.79333333333334
"W00922",86.55722222222222
"W00500",86.46666666666667
"W00982",86.31527777777778
"W00849",86.2838888888889
"W00911",86.21972222222222
"W01320",86.17194444444445
"W00688",86.10888888888888
"W00418",85.93555555555555
"W01315",85.93138888888889
"W00069",85.91694444444444
"W00344",85.88472222222222
"W00312",85.87611111111111
"W01292",85.845
"W00114",85.84333333333333
"W00281",85.84083333333334
